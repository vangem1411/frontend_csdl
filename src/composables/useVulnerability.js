// composables/useVulnerability.js
import { ref } from 'vue';
import api from './axios';

const selectedVulnerability = ref(null);
const API_BASE_URL = '/vulnerability';

export function useVulnerability() {
  const getVulnerabilityById = async (id) => {
    try {
      const response = await api.get(`${API_BASE_URL}/${id}`);
      selectedVulnerability.value = response.data;
      return response.data;
    } catch (error) {
      console.error('Lỗi khi lấy chi tiết lỗ hổng:', error);
      selectedVulnerability.value = null;
      throw error;
    }
  };

  const createVulnerabilityApi = async (data) => {
    try {
      const response = await api.post(API_BASE_URL, data);
      return response.data;
    } catch (error) {
      console.error('Lỗi khi tạo lỗ hổng:', error);
      throw error;
    }
  };

  const updateVulnerabilityApi = async (id, data) => {
    try {
      const response = await api.put(`${API_BASE_URL}/${id}`, data);
      return response.data;
    } catch (error) {
      console.error('Lỗi khi cập nhật lỗ hổng:', error);
      throw error;
    }
  };

  const deleteVulnerabilityApi = async (id) => {
    try {
      await api.delete(`${API_BASE_URL}/${id}`);
    } catch (error) {
      console.error('Lỗi khi xóa lỗ hổng:', error);
      throw error;
    }
  };

  return {
    selectedVulnerability,
    getVulnerabilityById,
    createVulnerabilityApi,
    updateVulnerabilityApi,
    deleteVulnerabilityApi
  };
}
